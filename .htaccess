RewriteEngine On
RewriteBase /v1/

# ----------------------------------------------------------------------
# 1. SECURITY: Block Access to Sensitive Files & Directories
# ----------------------------------------------------------------------

# Block access to specific sensitive files (dotfiles, composer, JSON secrets)
<FilesMatch "^\.env|composer\.(json|lock)|.*\.json$|\.git">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# Block access to sensitive directories (src, vendor, project_secret)
# This prevents direct access to your source code files
RewriteRule ^(src|vendor|project_secret)(/|$) - [F,L]

# ----------------------------------------------------------------------
# 2. ROUTING: Slim Framework Front Controller
# ----------------------------------------------------------------------

# If the request is not for a real file...
RewriteCond %{REQUEST_FILENAME} !-f
# ...and not for a real directory...
RewriteCond %{REQUEST_FILENAME} !-d
# ...redirect to index.php
RewriteRule ^ index.php [QSA,L]